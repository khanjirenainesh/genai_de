
 --================statement 1================ 
CREATE TABLE AU_WKS.WKS_ITG_CHW_ECOMM_DATA AS
SELECT
  PFC AS PRODUCT_PROBE_ID,
  SKUNAME AS PRODUCT_NAME,
  NEC1_DESC,
  NEC2_DESC,
  NEC3_DESC,
  BRAND,
  CATEGORY,
  OWNER,
  MANUFACTURER,
  MAT_YEAR,
  PERIODID AS TIME_PERIOD
  TO_DATE(WEEK_END, 'YYYY-MM-DD') AS WEEK_END_DT,
  CAST(SALES_ONLINE AS DECIMAL(10, 2)) AS SALES_VALUE,
  CAST(UNIT_ONLINE AS DECIMAL(10, 2)) AS SALES_QTY,
  'AUD' AS CRNCY,
  FILE_NAME,
  CURRENT_TIMESTAMP() AS CRT_DTTM,
  CURRENT_TIMESTAMP() AS UPDT_DTTM

 AU_SDL.sdl_chw_ecomm_data
  

 --================statement 2================ 
DELETE FROM AU_ITG.itg_chw_ecomm_data USING AU_WKS.WKS_ITG_CHW_ECOMM_DATA AS WKS
WHERE
  WKS.WEEK_END_DT = ITG_CHW_ECOMM_DATA.WEEK_END_DT;

 --================statement 3================ 
INSERT INTO AU_ITG.ITG_CHW_ECOMM_DATA
SELECT
  *
FROM AU_WKS.WKS_ITG_CHW_ECOMM_DATA;

 --================statement 4================ 
DROP TABLE AU_WKS.WKS_ITG_CHW_ECOMM_DATA;
